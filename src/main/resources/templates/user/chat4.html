<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="http://www.jq22.com/jquery/1.9.1/jquery.min.js"></script>
    <script src="https://cdn.bootcss.com/sockjs-client/1.4.0/sockjs.js"></script>
    <script src="https://cdn.bootcss.com/stomp.js/2.3.3/stomp.js"></script>
    <title>Title</title>
</head>
<body>
聊天室：当前用户id是：${id}

<div id="msg"></div>

<textarea id="content"></textarea><br>

接收人的id：
<select id="userId">
    <option value="">全部</option>
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
</select>
<input type="button" id="send" value="发送" />
以下是我接收到的消息：
<div id="getMessage">

</div>

<script>
    var id = '${id}';
    var sock = new SockJS('http://localhost:8088/rwx/socket');
    var stompClient = Stomp.over(sock);
    stompClient.connect({},function (data) {
        console.log(data);
        stompClient.subscribe("/user/"+id+"/message/get",function (response) {
            var message = JSON.parse(response.body);
            $("#getMessage").append('<div class="message"><span>发送人：'+message.fromUserId+'</span><span>消息：'+message.content+'</span> ')
        });
    });
    $("#send").click(function () {
        var content = $("#content").val();
        var userId = $("#userId").val();
        stompClient.send("/message",{},JSON.stringify({
            content:content,
            toUserId:userId,
            fromUserId:id
        }));
    });
</script>
</body>
</html>